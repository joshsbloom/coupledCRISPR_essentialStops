#### analysis for the coupled-CRISPR essential stop engineering project

for complete analysis pipeline and pre-processing see [code/](code/)

see [04_core_analysis.R](code/04_core_analysis.R) for the main analysis

complete experiment data for 08/23/16 hiseq runs is availabe at:
[082316/](https://drive.google.com/open?id=0ByJ-NQ1MGtWIMXNacU55dGVXWUk)

___
Start here:

<!---for tables of counts per oligo see [processed/RData/count_tables.RData](https://drive.google.com/open?id=0ByJ-NQ1MGtWIa3RraUhfa1BwQU0)
which contains 3 data frames (10791 oligos x 12 conditions/time points ):
+ all.counts2 (unfiltered total counts)
+ all.counts.perfect (total perfect counts)
+ all.barcode.diversity (total number of unique barcodes per oligo)
-->
<!--
for data frame of oligo annotations see [processed/RData/oligoAnnotations.RData](https://drive.google.com/open?id=0ByJ-NQ1MGtWIR3pKWk5qeGZBUjg)
-->
for raw barcode level data see [processed/RData/big.mm.RData](https://dl.dropboxusercontent.com/u/363373/CoupledCRISPR/big.mm.RData)

for processed oligo and gene level results see [processed/RData/oligo.stats.RData](https://dl.dropboxusercontent.com/u/363373/CoupledCRISPR/oligo.stats.EssentialBlups.RData)

for HMM plots see [HMMv9/] (https://dl.dropboxusercontent.com/u/363373/CoupledCRISPR/HMM_v10.zip)


```r
#Structure of oligo.stats table
R> str(oligo.stats, list.len=ncol(oligo.stats))
'data.frame':	10971 obs. of  154 variables:
 $ GENEID                                   : chr  "YAL001C" "YAL001C" "YAL001C" "YAL001C" ...
 $ chr                                      : chr  "chrI" "chrI" "chrI" "chrI" ...
 $ start                                    : int  147630 147888 147933 148320 148341 148920 149178 149268 150723 143077 ...
 $ end                                      : int  147632 147890 147935 148322 148343 148922 149180 149270 150725 143079 ...
 $ coding                                   : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...
 $ Index                                    : int  15301 15318 6322 6335 15339 15368 15376 15381 6391 15138 ...
 $ guide                                    : chr  "TACTGATTTTGATGGCTATT" "AGACAAAATTGAATACAGCA" "GAATTGGCATATATAATCAG" "ATTTCATTTCTAGTGGTCGA" ...
 $ guideStrand                              : chr  "-" "-" "+" "+" ...
 $ case                                     : int  -2 0 0 0 0 -1 0 -2 1 -1 ...
 $ codingStrand                             : chr  "-" "-" "-" "-" ...
 $ varAllele                                : chr  "TGA" "TGA" "TGA" "TGA" ...
 $ CDSLOC.start                             : int  3445 3187 3142 2755 2734 2155 1897 1807 352 538 ...
 $ CDSLOC.end                               : int  3447 3189 3144 2757 2736 2157 1899 1809 354 540 ...
 $ CDSLOC.width                             : int  3 3 3 3 3 3 3 3 3 3 ...
 $ PROTEINLOC                               : int  1149 1063 1048 919 912 719 633 603 118 180 ...
 $ QUERYID                                  : int  468 485 418 431 506 535 543 548 487 463 ...
 $ TXID                                     : int  104 104 104 104 104 104 104 104 104 39 ...
 $ CDSID                                    : chr  "106" "106" "106" "106" ...
 $ CONSEQUENCE                              : chr  "nonsense" "nonsense" "nonsense" "nonsense" ...
 $ REFCODON                                 : chr  "GTC" "AGG" "CCT" "CCT" ...
 $ VARCODON                                 : chr  "TGA" "TGA" "TGA" "TGA" ...
 $ REFAA                                    : chr  "V" "R" "P" "P" ...
 $ VARAA                                    : chr  "*" "*" "*" "*" ...
 $ stopPAM_oligos                           : chr  "ACACCTCATTTCATTATGTAGATTCATATATAGAATACCAATTATGATTTCACCAATAGCCATCAAAATCAGTAGTTATTAATACTTGTCTTTCTAGGAGC" "CCCATAAACGAGAAAATGGTTTGCCCAGTGGAACTTTGACAGCAGACTTTCATGCTGTATTCAATTTTGTCTGAGAATTGGCATATATAATCAGAGGGGGA" "ACTTCCTTGCTGTATTCAATTTTGTCTGAGAATTGGCATATATAATCAGTCAGGGAGTTAATGTTCGTATTTCAAATCTCCTTGAAGTATACGTTAAAGGT" "ATTCGTTTCCAACGTTCTTCAACGCCTCTATTTCATTTCTAGTGGTCGATCAACTTTCTATTAATATGGACCGGATCACTGTGCGAATATAATCGTCGCTT" ...
 $ CDS_length                               : int  1161 1161 1161 1161 1161 1161 1161 1161 1161 207 ...
 $ dist_from_CDS_end                        : int  12 98 113 242 249 442 528 558 1043 27 ...
 $ final.oligo.toSynth                      : chr  "CGCGTCGAGTAGGGTGGTGACCTACTGATTTTGATGGCTATTGTTTTAGAGCATGCCGATCGATACGCGTACACCTCATTTCATTATGTAGATTCATATATAGAATACCAATTATGATTTCACCAAT"| __truncated__ "GCCGTGTGAAGCTGGTCCCCCTCTGATTATATATGCCAATTCTCAGACAAAATTGAATACAGCATGAAAGTCTGCTGTCAAAGTTCCACTGGGCAAACCATTTTCTCGTTTATGGGACGCGTATCGA"| __truncated__ "CGCGTCGAGTAGGGTGGTGACCGAATTGGCATATATAATCAGGTTTTAGAGCATGCCGATCGATACGCGTACTTCCTTGCTGTATTCAATTTTGTCTGAGAATTGGCATATATAATCAGTCAGGGAG"| __truncated__ "CGCGTCGAGTAGGGTGGTGACCATTTCATTTCTAGTGGTCGAGTTTTAGAGCATGCCGATCGATACGCGTATTCGTTTCCAACGTTCTTCAACGCCTCTATTTCATTTCTAGTGGTCGATCAACTTT"| __truncated__ ...
 $ oligo                                    : chr  "chrI:147630:147632:15301:TACTGATTTTGATGGCTATT:-:-2:-:TGA:3445:3447:3:1149:468:104:106:YAL001C:nonsense:GTC:TGA:V:*:1161:12" "chrI:147888:147890:15318:AGACAAAATTGAATACAGCA:-:0:-:TGA:3187:3189:3:1063:485:104:106:YAL001C:nonsense:AGG:TGA:R:*:1161:98" "chrI:147933:147935:6322:GAATTGGCATATATAATCAG:+:0:-:TGA:3142:3144:3:1048:418:104:106:YAL001C:nonsense:CCT:TGA:P:*:1161:113" "chrI:148320:148322:6335:ATTTCATTTCTAGTGGTCGA:+:0:-:TGA:2755:2757:3:919:431:104:106:YAL001C:nonsense:CCT:TGA:P:*:1161:242" ...
 $ dubious                                  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ flagsyn                                  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ drop                                     : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ repair.coding.strand                     : chr  "GCTCCTAGAAAGACAAGTATTAATAACTACTGATTTTGATGGCTATTGGTGAAATCATAATTGGTATTCTATATATGAATCTACATAATGAAATGAGGTGT" "TCCCCCTCTGATTATATATGCCAATTCTCAGACAAAATTGAATACAGCATGAAAGTCTGCTGTCAAAGTTCCACTGGGCAAACCATTTTCTCGTTTATGGG" "ACCTTTAACGTATACTTCAAGGAGATTTGAAATACGAACATTAACTCCCTGACTGATTATATATGCCAATTCTCAGACAAAATTGAATACAGCAAGGAAGT" "AAGCGACGATTATATTCGCACAGTGATCCGGTCCATATTAATAGAAAGTTGATCGACCACTAGAAATGAAATAGAGGCGTTGAAGAACGTTGGAAACGAAT" ...
 $ unique.Index                             : int  1 2 3 4 5 6 7 8 9 10 ...
 $ low.complexity.downstream.cnt            : num  0 0 0 0 0 0 0 0 2 0 ...
 $ domain.downstream                        : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ domains.downstream                       : chr  "" "" "" "" ...
 $ yORF                                     : chr  "YAL001C" "YAL001C" "YAL001C" "YAL001C" ...
 $ orfid                                    : int  206 206 206 206 206 206 206 206 206 2828 ...
 $ gene_name.x                              : Factor w/ 4322 levels "","AAC1","AAC3",..: 3795 3795 3795 3795 3795 3795 3795 3795 3795 932 ...
 $ GFP_tagged                               : Factor w/ 2 levels "not tagged","tagged": 2 2 2 2 2 2 2 2 2 1 ...
 $ GFP_visualized                           : Factor w/ 2 levels "not visualized",..: 2 2 2 2 2 2 2 2 2 1 ...
 $ TAP_visualized                           : Factor w/ 2 levels "TAP visualized",..: 1 1 1 1 1 1 1 1 1 2 ...
 $ abundance                                : num  125 125 125 125 125 125 125 125 125 NA ...
 $ error                                    : num  NA NA NA NA NA NA NA NA NA NA ...
 $ localization_summary                     : Factor w/ 125 levels "","ER","ER to Golgi",..: 77 77 77 77 77 77 77 77 77 1 ...
 $ ambiguous                                : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ mitochondrion                            : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ vacuole                                  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ spindle_pole                             : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ cell_periphery                           : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ punctate_composite                       : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ vacuolar_membrane                        : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ ER                                       : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ nuclear_periphery                        : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ endosome                                 : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ bud_neck                                 : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ microtubule                              : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ Golgi                                    : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ late_Golgi                               : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ peroxisome                               : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ actin                                    : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ nucleolus                                : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ cytoplasm                                : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...
 $ ER_to_Golgi                              : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ early_Golgi                              : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ lipid_particle                           : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ nucleus                                  : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...
 $ bud                                      : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ missingAbundance                         : Factor w/ 3 levels "low signal","not visualized",..: NA NA NA NA NA NA NA NA NA 2 ...
 $ gene_name.y                              : Factor w/ 3429 levels "","37164","AAC1",..: 3014 3014 3014 3014 3014 3014 3014 3014 3014 NA ...
 $ YEPD.mean                                : num  NA NA NA NA NA NA NA NA NA NA ...
 $ YEPD.error                               : num  NA NA NA NA NA NA NA NA NA NA ...
 $ SD.mean                                  : num  NA NA NA NA NA NA NA NA NA NA ...
 $ SD.error                                 : num  NA NA NA NA NA NA NA NA NA NA ...
 $ Gene.Name                                : chr  "TFC3" "TFC3" "TFC3" "TFC3" ...
 $ Raw.Half.life                            : int  475 475 475 475 475 475 475 475 475 NA ...
 $ Corrected.Half.Life                      : int  475 475 475 475 475 475 475 475 475 NA ...
 $ mean.aa.perfect.conserved                : num  0.857 0.857 0.857 0.857 0.857 ...
 $ frac.aa.perfect.conserved                : num  0.695 0.695 0.695 0.695 0.695 ...
 $ end.conservation                         : num  0.417 0.612 0.566 0.636 0.635 ...
 $ Orthogroup                               : Factor w/ 5152 levels "OG1","OG10","OG100",..: 4698 4698 4698 4698 4698 4698 4698 4698 4698 4676 ...
 $ OG.Quality                               : Factor w/ 4 levels "assignment.aln",..: 4 4 4 4 4 4 4 4 4 2 ...
 $ Length                                   : int  3498 3498 3498 3498 3498 3498 3498 3498 3498 621 ...
 $ dN_H0                                    : num  0.229 0.229 0.229 0.229 0.229 ...
 $ dS_H0                                    : num  2.09 2.09 2.09 2.09 2.09 ...
 $ H0_w                                     : num  0.109 0.109 0.109 0.109 0.109 ...
 $ dS.filter                                : int  1 1 1 1 1 1 1 1 1 0 ...
 $ gene                                     : chr  "TFC3      " "TFC3      " "TFC3      " "TFC3      " ...
 $ go_process                               : chr  "transcription initiation from Pol III promoter" "transcription initiation from Pol III promoter" "transcription initiation from Pol III promoter" "transcription initiation from Pol III promoter" ...
 $ go_function                              : chr  "RNA polymerase III transcription factor activity" "RNA polymerase III transcription factor activity" "RNA polymerase III transcription factor activity" "RNA polymerase III transcription factor activity" ...
 $ go_component                             : chr  "transcription factor TFIIIC complex" "transcription factor TFIIIC complex" "transcription factor TFIIIC complex" "transcription factor TFIIIC complex" ...
 $ essential                                : chr  "YES" "YES" "YES" "YES" ...
 $ het_ypd_A                                : chr  "1.006" "1.006" "1.006" "1.006" ...
 $ het_ypd_B                                : chr  "1.007" "1.007" "1.007" "1.007" ...
 $ HET_AV                                   : num  1.01 1.01 1.01 1.01 1.01 ...
 $ slow_ypd_het                             : chr  "no" "no" "no" "no" ...
 $ hom_ypd_C                                : chr  "ND" "ND" "ND" "ND" ...
 $ hom_ypd_D                                : chr  "ND" "ND" "ND" "ND" ...
 $ HOM_AV                                   : chr  "ND" "ND" "ND" "ND" ...
 $ slow_ypd_hom                             : chr  "Essential" "Essential" "Essential" "Essential" ...
 $ het_mm_B                                 : chr  "1.007" "1.007" "1.007" "1.007" ...
 $ slow_mm_het                              : chr  "no" "no" "no" "no" ...
 $ hom_mm_D                                 : chr  "ND" "ND" "ND" "ND" ...
 $ slow_mm_hom                              : chr  "Essential" "Essential" "Essential" "Essential" ...
 $ viable_annotation                        : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ evolvability                             : chr  "Non-evolvable" "Non-evolvable" "Non-evolvable" "Non-evolvable" ...
 $ human_complements_null                   : chr  NA NA NA NA ...
 $ guide.GCcontent                          : num  0.3 0.3 0.3 0.35 0.35 0.4 0.5 0.45 0.4 0.45 ...
 $ PAMvariantCNT                            : int  3 2 3 3 2 2 2 2 3 2 ...
 $ cnt.offtarget                            : num  1 1 1 1 1 1 2 1 1 1 ...
 $ dup.gRNA                                 : num  0 0 0 0 0 0 0 0 0 0 ...
 $ WT.cnt                                   : num  3 4 3 13 9 16 6 NA 19 2 ...
 $ WT.Intercept                             : num  -10.9 -10.9 -11.3 -10.8 -11.2 ...
 $ WT.slope                                 : num  -0.0452 -0.0973 -0.0481 -0.0466 -0.0608 ...
 $ WT.p.value                               : num  6.40e-04 1.88e-03 8.44e-04 5.23e-06 6.21e-06 ...
 $ WT.slope.025                             : num  -0.0534 -0.1285 -0.0576 -0.0595 -0.0739 ...
 $ WT.slope.975                             : num  -0.0371 -0.0661 -0.0387 -0.0338 -0.0478 ...
 $ NMD.cnt                                  : num  2 3 5 11 6 15 2 NA 10 2 ...
 $ NMD.Intercept                            : num  -10.1 -10.5 -10.3 -10.8 -10.7 ...
 $ NMD.slope                                : num  -0.0174 -0.0453 -0.0429 -0.0549 -0.0602 ...
 $ NMD.p.value                              : num  5.06e-01 2.79e-03 9.12e-05 4.57e-05 5.98e-04 ...
 $ NMD.slope.025                            : num  -0.0663 -0.0578 -0.0513 -0.0782 -0.0786 ...
 $ NMD.slope.975                            : num  0.0314 -0.0329 -0.0345 -0.0316 -0.0419 ...
 $ ALL.cnt                                  : num  5 7 8 24 15 31 8 NA 29 4 ...
 $ ALL.Intercept                            : num  -11.5 -11.4 -11.2 -11.7 -11.6 ...
 $ ALL.slope                                : num  -0.0359 -0.0759 -0.0455 -0.0501 -0.0608 ...
 $ ALL.p.value                              : num  1.70e-02 4.17e-04 1.61e-07 1.38e-08 1.38e-08 ...
 $ ALL.slope.025                            : num  -0.0579 -0.1016 -0.0515 -0.0619 -0.0715 ...
 $ ALL.slope.975                            : num  -0.014 -0.0502 -0.0396 -0.0382 -0.0501 ...
 $ ALL.expt.eff                             : num  0.40053 0.07963 -0.56709 0.37375 -0.00166 ...
 $ ALL.p.value.expt                         : num  0.3045 0.7736 0.1624 0.0921 0.9975 ...
 $ slope.oligo.blup                         : num  0.01269 -0.01232 0.00861 0.00269 -0.00262 ...
 $ slope.oligo.blup.postVar                 : num  1.70e-04 1.45e-04 1.36e-04 8.06e-05 9.95e-05 ...
 $ binarized.oligo.blup                     : num  0.628 -0.618 -0.677 0.042 -1.02 ...
 $ binarized.oligo.blup.postVar             : num  1.07 1.47 1.43 0.65 1.23 ...
 $ slope.gene.blup                          : num  -0.00704 -0.00704 -0.00704 -0.00704 -0.00704 ...
 $ slope.gene.blup.postVar                  : num  4.29e-05 4.29e-05 4.29e-05 4.29e-05 4.29e-05 ...
 $ binarized.gene.blup                      : num  -1.01 -1.01 -1.01 -1.01 -1.01 ...
 $ binarized.gene.blup.postVar              : num  0.308 0.308 0.308 0.308 0.308 ...
 $ gp                                       : chr  "YAL001C:12" "YAL001C:98" "YAL001C:113" "YAL001C:242" ...
 $ hmm2                                     : num  1 2 2 2 2 2 2 NA 2 1 ...
 $ hmm3                                     : num  1 2 2 2 2 2 2 NA 2 1 ...
 $ binarized.oligo.blup.EssentialAll        : num  0.457 -0.769 -0.844 -0.159 -1.177 ...
 $ binarized.oligo.blup.postVar.EssentialAll: num  1.038 1.448 1.398 0.604 1.225 ...
 $ binarized.gene.blup.EssentialAll         : num  -0.702 -0.702 -0.702 -0.702 -0.702 ...
 $ binarized.gene.blup.postVar.EssentialAll : num  0.236 0.236 0.236 0.236 0.236 ...
 $ binarized.oligo.blup.EssentialWT         : num  -0.431 -0.54 -0.379 -0.217 -0.847 ...
 $ binarized.oligo.blup.postVar.EssentialWT : num  1.932 1.807 1.993 0.899 1.544 ...
 $ binarized.gene.blup.EssentialWT          : num  -0.733 -0.733 -0.733 -0.733 -0.733 ...
 $ binarized.gene.blup.postVar.EssentialWT  : num  0.298 0.298 0.298 0.298 0.298 ...
 $ binarized.oligo.blup.EssentialNMD        : num  0.736 -0.507 -0.823 -0.12 -0.962 ...
 $ binarized.oligo.blup.postVar.EssentialNMD: num  1.298 1.589 1.354 0.857 1.359 ...
 $ binarized.gene.blup.EssentialNMD         : num  -0.427 -0.427 -0.427 -0.427 -0.427 ...
 $ binarized.gene.blup.postVar.EssentialNMD : num  0.245 0.245 0.245 0.245 0.245 ...
```
